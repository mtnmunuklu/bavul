<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# vulnerability

```go
import "github.com/mtnmunuklu/bavul/vulnerability"
```

## Index



# fetchers

```go
import "github.com/mtnmunuklu/bavul/vulnerability/fetchers"
```

## Index

- [type CvssData](<#CvssData>)
- [type NVDClient](<#NVDClient>)
- [type NVDCve](<#NVDCve>)
- [type NVDData](<#NVDData>)
- [type NVDFetcher](<#NVDFetcher>)
  - [func NewNVDFetcher\(\) \*NVDFetcher](<#NewNVDFetcher>)
  - [func \(fetcher \*NVDFetcher\) ConvertNvdDataToCVE\(nvdData NVDData\) \[\]models.CVE](<#NVDFetcher.ConvertNvdDataToCVE>)
  - [func \(fetcher \*NVDFetcher\) FetchCVEData\(\) \(NVDData, error\)](<#NVDFetcher.FetchCVEData>)
  - [func \(fetcher \*NVDFetcher\) SetNVDClient\(client NVDClient\)](<#NVDFetcher.SetNVDClient>)
  - [func \(fetcher \*NVDFetcher\) SetNVDKey\(key string\)](<#NVDFetcher.SetNVDKey>)


<a name="CvssData"></a>
## type [CvssData](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L103-L113>)



```go
type CvssData struct {
    Version               string  `json:"version"`
    VectorString          string  `json:"vectorString"`
    AccessVector          string  `json:"accessVector"`
    AccessComplexity      string  `json:"accessComplexity"`
    Authentication        string  `json:"authentication"`
    ConfidentialityImpact string  `json:"confidentialityImpact"`
    IntegrityImpact       string  `json:"integrityImpact"`
    AvailabilityImpact    string  `json:"availabilityImpact"`
    BaseScore             float64 `json:"baseScore"`
}
```

<a name="NVDClient"></a>
## type [NVDClient](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L32-L35>)



```go
type NVDClient interface {
    FetchCVEData() (NVDData, error)
    ConvertNvdDataToCVE(nvdData NVDData) []models.CVE
}
```

<a name="NVDCve"></a>
## type [NVDCve](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L37-L93>)



```go
type NVDCve struct {
    Cve struct {
        ID               string `json:"id"`
        SourceIdentifier string `json:"sourceIdentifier"`
        PublishedDate    string `json:"published"`
        LastModifiedDate string `json:"lastModified"`
        VulnStatus       string `json:"vulnStatus"`
        Description      []struct {
            Lang  string `json:"lang"`
            Value string `json:"value"`
        }   `json:"descriptions"`
        Metrics struct {
            BaseMetricV31 []struct {
                CvssData            CvssData `json:"cvssData"`
                ExploitabilityScore float64  `json:"exploitabilityScore"`
                ImpactScore         float64  `json:"impactScore"`
            }   `json:"cvssMetricV31"`
            BaseMetricV3 []struct {
                CvssData            CvssData `json:"cvssData"`
                ExploitabilityScore float64  `json:"exploitabilityScore"`
                ImpactScore         float64  `json:"impactScore"`
            }   `json:"cvssMetricV30"`
            BaseMetricV2 []struct {
                Source                  string   `json:"source"`
                Type                    string   `json:"type"`
                CvssData                CvssData `json:"cvssData"`
                BaseSeverity            string   `json:"baseSeverity"`
                ExploitabilityScore     float64  `json:"exploitabilityScore"`
                ImpactScore             float64  `json:"impactScore"`
                AcInsufInfo             bool     `json:"acInsufInfo"`
                ObtainAllPrivilege      bool     `json:"obtainAllPrivilege"`
                ObtainUserPrivilege     bool     `json:"obtainUserPrivilege"`
                ObtainOtherPrivilege    bool     `json:"obtainOtherPrivilege"`
                UserInteractionRequired bool     `json:"userInteractionRequired"`
            }   `json:"cvssMetricV2"`
        }   `json:"metrics"`
        References []struct {
            URL       string `json:"url"`
            Refsource string `json:"source"`
        }   `json:"references"`
        Configurations []struct {
            Nodes []struct {
                Operator string `json:"operator"`
                Negate   bool   `json:"negate"`
                CpeMatch []struct {
                    Criteria              string `json:"criteria"`
                    MatchCriteriaID       string `json:"matchCriteriaId"`
                    Vulnerable            bool   `json:"vulnerable"`
                    VersionStartIncluding string `json:"versionStartIncluding"`
                    VersionStartExcluding string `json:"versionStartExcluding"`
                    VersionEndIncluding   string `json:"versionEndIncluding"`
                    VersionEndExcluding   string `json:"versionEndExcluding"`
                }   `json:"cpeMatch"`
            } `json:"nodes"`
        }   `json:"configurations"`
    } `json:"cve"`
}
```

<a name="NVDData"></a>
## type [NVDData](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L95-L101>)



```go
type NVDData struct {
    StartIndex        int      `json:"startIndex"`
    TotalResultsCount int      `json:"totalResults"`
    CVEItems          []NVDCve `json:"vulnerabilities"`
    DataFormat        string   `json:"format"`
    DataVersion       string   `json:"version"`
}
```

<a name="NVDFetcher"></a>
## type [NVDFetcher](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L15-L18>)



```go
type NVDFetcher struct {
    NVDKey    string
    NVDClient NVDClient
}
```

<a name="NewNVDFetcher"></a>
### func [NewNVDFetcher](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L20>)

```go
func NewNVDFetcher() *NVDFetcher
```



<a name="NVDFetcher.ConvertNvdDataToCVE"></a>
### func \(\*NVDFetcher\) [ConvertNvdDataToCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L205>)

```go
func (fetcher *NVDFetcher) ConvertNvdDataToCVE(nvdData NVDData) []models.CVE
```

ConvertNvdDataToCVE converts NvdData to an array of CVE structs.

<a name="NVDFetcher.FetchCVEData"></a>
### func \(\*NVDFetcher\) [FetchCVEData](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L116>)

```go
func (fetcher *NVDFetcher) FetchCVEData() (NVDData, error)
```

FetchCVEData fetches CVE data from NVD API and returns the result.

<a name="NVDFetcher.SetNVDClient"></a>
### func \(\*NVDFetcher\) [SetNVDClient](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L28>)

```go
func (fetcher *NVDFetcher) SetNVDClient(client NVDClient)
```



<a name="NVDFetcher.SetNVDKey"></a>
### func \(\*NVDFetcher\) [SetNVDKey](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/fetchers/nvd.go#L24>)

```go
func (fetcher *NVDFetcher) SetNVDKey(key string)
```



# models

```go
import "github.com/mtnmunuklu/bavul/vulnerability/models"
```

## Index

- [type CVE](<#CVE>)
  - [func \(cve \*CVE\) FromProto\(proto \*pb.CVE\)](<#CVE.FromProto>)
  - [func \(cve \*CVE\) ToProto\(\) \*pb.CVE](<#CVE.ToProto>)


<a name="CVE"></a>
## type [CVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/models/cve.go#L12-L22>)

CVE model represents a Common Vulnerabilities and Exposures entry

```go
type CVE struct {
    Id          bson.ObjectId `bson:"_id"`
    CveId       string        `bson:"cve_id"`
    Description string        `bson:"description"`
    Severity    string        `bson:"severity"`
    Product     string        `bson:"product"`
    Vendor      string        `bson:"vendor"`
    Links       []string      `bson:"links"`
    Published   time.Time     `bson:"published"`
    Modified    time.Time     `bson:"modified"`
}
```

<a name="CVE.FromProto"></a>
### func \(\*CVE\) [FromProto](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/models/cve.go#L40>)

```go
func (cve *CVE) FromProto(proto *pb.CVE)
```

FromProto converts the Protobuf message to the corresponding CVE model.

<a name="CVE.ToProto"></a>
### func \(\*CVE\) [ToProto](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/models/cve.go#L25>)

```go
func (cve *CVE) ToProto() *pb.CVE
```

ToProto converts the CVE model to the corresponding Protobuf message.

# repository

```go
import "github.com/mtnmunuklu/bavul/vulnerability/repository"
```

## Index

- [Constants](<#constants>)
- [type CVERepository](<#CVERepository>)
  - [func NewCVERepository\(conn db.Connection\) CVERepository](<#NewCVERepository>)


## Constants

<a name="CVECollection"></a>

```go
const CVECollection = "cves"
```

<a name="CVERepository"></a>
## type [CVERepository](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/repository/cve.go#L14-L22>)

CVERepository is the interface of the vulnerability backend.

```go
type CVERepository interface {
    Save(cve *models.CVE) error
    GetById(id string) (cve *models.CVE, err error)
    GetByCVEId(cveId string) (cve *models.CVE, err error)
    SearchCVEs(cveId, severity, product, vendor, startDate, endDate string) (cves []*models.CVE, err error)
    GetAll() (cves []*models.CVE, err error)
    Update(cve *models.CVE) error
    DeleteById(id string) error
}
```

<a name="NewCVERepository"></a>
### func [NewCVERepository](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/repository/cve.go#L30>)

```go
func NewCVERepository(conn db.Connection) CVERepository
```

NewCVERepository creates a new CVERepository instance.

# service

```go
import "github.com/mtnmunuklu/bavul/vulnerability/service"
```

## Index

- [func NewVulnService\(cveRepository repository.CVERepository\) pb.VulnServiceServer](<#NewVulnService>)
- [type VulnService](<#VulnService>)
  - [func \(s \*VulnService\) AddCVE\(ctx context.Context, req \*pb.AddCVERequest\) \(\*pb.CVE, error\)](<#VulnService.AddCVE>)
  - [func \(s \*VulnService\) DeleteCVE\(ctx context.Context, req \*pb.DeleteCVERequest\) \(\*pb.DeleteCVEResponse, error\)](<#VulnService.DeleteCVE>)
  - [func \(s \*VulnService\) FetchNVDFeeds\(req \*pb.FetchNVDFeedsRequest, stream pb.VulnService\_FetchNVDFeedsServer\) error](<#VulnService.FetchNVDFeeds>)
  - [func \(s \*VulnService\) GetAllCVEs\(req \*pb.GetAllCVEsRequest, stream pb.VulnService\_GetAllCVEsServer\) error](<#VulnService.GetAllCVEs>)
  - [func \(s \*VulnService\) SearchCVE\(req \*pb.SearchCVERequest, stream pb.VulnService\_SearchCVEServer\) error](<#VulnService.SearchCVE>)
  - [func \(s \*VulnService\) UpdateCVE\(ctx context.Context, req \*pb.UpdateCVERequest\) \(\*pb.CVE, error\)](<#VulnService.UpdateCVE>)


<a name="NewVulnService"></a>
## func [NewVulnService](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L19>)

```go
func NewVulnService(cveRepository repository.CVERepository) pb.VulnServiceServer
```



<a name="VulnService"></a>
## type [VulnService](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L15-L17>)



```go
type VulnService struct {
    // contains filtered or unexported fields
}
```

<a name="VulnService.AddCVE"></a>
### func \(\*VulnService\) [AddCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L23>)

```go
func (s *VulnService) AddCVE(ctx context.Context, req *pb.AddCVERequest) (*pb.CVE, error)
```



<a name="VulnService.DeleteCVE"></a>
### func \(\*VulnService\) [DeleteCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L72>)

```go
func (s *VulnService) DeleteCVE(ctx context.Context, req *pb.DeleteCVERequest) (*pb.DeleteCVEResponse, error)
```



<a name="VulnService.FetchNVDFeeds"></a>
### func \(\*VulnService\) [FetchNVDFeeds](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L136>)

```go
func (s *VulnService) FetchNVDFeeds(req *pb.FetchNVDFeedsRequest, stream pb.VulnService_FetchNVDFeedsServer) error
```



<a name="VulnService.GetAllCVEs"></a>
### func \(\*VulnService\) [GetAllCVEs](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L56>)

```go
func (s *VulnService) GetAllCVEs(req *pb.GetAllCVEsRequest, stream pb.VulnService_GetAllCVEsServer) error
```



<a name="VulnService.SearchCVE"></a>
### func \(\*VulnService\) [SearchCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L164>)

```go
func (s *VulnService) SearchCVE(req *pb.SearchCVERequest, stream pb.VulnService_SearchCVEServer) error
```



<a name="VulnService.UpdateCVE"></a>
### func \(\*VulnService\) [UpdateCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/service/service.go#L91>)

```go
func (s *VulnService) UpdateCVE(ctx context.Context, req *pb.UpdateCVERequest) (*pb.CVE, error)
```



# util

```go
import "github.com/mtnmunuklu/bavul/vulnerability/util"
```

## Index

- [Variables](<#variables>)
- [func CheckSeverity\(severity string\) \(string, error\)](<#CheckSeverity>)
- [func FormatTime\(t time.Time\) string](<#FormatTime>)
- [func IsValidCVE\(cveID string\) bool](<#IsValidCVE>)
- [func NormalizeCVEId\(cveId string\) string](<#NormalizeCVEId>)
- [func ParseTime\(dateStr string\) time.Time](<#ParseTime>)
- [func ValidateCVEId\(cveId string\) \(string, error\)](<#ValidateCVEId>)


## Variables

<a name="ErrInvalidCVEId"></a>Contains error codes for authentication service.

```go
var (
    ErrInvalidCVEId          = errors.New("invalid cve id")
    ErrInvalidSecurityLevel  = errors.New("invalid security level")
    ErrEmptyCVEId            = errors.New("cve id can't be empty")
    ErrExistCVE              = errors.New("cve already exist")
    ErrNotFoundCVE           = errors.New("cve could not be found")
    ErrAddCVE                = errors.New("cve could not be created")
    ErrDeleteCVE             = errors.New("cve could not be deleted")
    ErrUpdateCVE             = errors.New("cve could not be updated")
    ErrNotPerformedOperation = errors.New("operation could not be performed")
)
```

<a name="CheckSeverity"></a>
## func [CheckSeverity](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L75>)

```go
func CheckSeverity(severity string) (string, error)
```

CheckSeverity function checks if the given string is a valid severity value \("None", "Low", "Medium", "High", "Critical"\). If valid, it converts the string to a format starting with an uppercase letter. If not valid, it returns an error.

<a name="FormatTime"></a>
## func [FormatTime](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L67>)

```go
func FormatTime(t time.Time) string
```



<a name="IsValidCVE"></a>
## func [IsValidCVE](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L47>)

```go
func IsValidCVE(cveID string) bool
```

isValidCVE checks if the given string is a valid CVE ID

<a name="NormalizeCVEId"></a>
## func [NormalizeCVEId](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L42>)

```go
func NormalizeCVEId(cveId string) string
```

NormalizeCVEId normalizes the CVE id.

<a name="ParseTime"></a>
## func [ParseTime](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L58>)

```go
func ParseTime(dateStr string) time.Time
```



<a name="ValidateCVEId"></a>
## func [ValidateCVEId](<https://github.com/mtnmunuklu/bavul/blob/main/vulnerability/util/util.go#L27>)

```go
func ValidateCVEId(cveId string) (string, error)
```

ValidateCVEId validates the CVE id.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
